<!DOCTYPE html>
<html>
<head>
    <title>Consentimientos TuSalud</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://apps.powerapps.com/play/powerapps.js"></script>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: Arial, sans-serif; 
            background: #f5f5f5;
            overflow: hidden;
        }
        
        /* Pantalla de login */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            text-align: center;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            max-width: 400px;
            width: 90%;
        }
        
        h2 {
            color: #28a745;
            margin-bottom: 10px;
        }
        
        input {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        button {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
        }
        
        button:hover {
            background: #218838;
        }
        
        .error {
            color: #dc3545;
            margin-top: 10px;
            display: none;
        }
        
        /* Contenedor de la Power App */
        #app-container {
            width: 100%;
            height: 100vh;
            border: none;
        }
        
        /* Ocultar barra de navegaci√≥n cuando la app est√© cargada */
        .powerapps-container iframe {
            border: none;
        }
    </style>
</head>
<body>

<!-- 1. PANTALLA DE LOGIN (aparece primero) -->
<div id="loginOverlay" class="login-overlay">
    <div class="login-box">
        <h2>üîê Consentimientos TuSalud</h2>
        <p>Acceso para personal autorizado</p>
        <input type="password" id="codigoAcceso" placeholder="Ingresa el c√≥digo de acceso">
        <button onclick="verificarCodigo()">INGRESAR A LA APLICACI√ìN</button>
        <p class="error" id="errorMsg">C√≥digo incorrecto. Intenta nuevamente.</p>
        <p style="margin-top: 20px; font-size: 12px; color: #666;">
            üìû Soporte: 601-1234567
        </p>
    </div>
</div>

<!-- 2. CONTENEDOR PARA LA POWER APP (oculto inicialmente) -->
<div id="app-container" style="display: none;"></div>

<script>
// ================= CONFIGURACI√ìN =================
// 1. REEMPLAZA ESTO CON TU APP ID REAL:
const APP_ID = "e6fea69f-80e5-4579-8f01-f087a031aee6"; 
// Ejemplo: "12345678-1234-1234-1234-123456789012"

// 2. C√≥digo de acceso (c√°mbialo cuando quieras):
const CODIGO_CORRECTO = "TUSALUD2024";

// ================= FUNCIONES =================
function verificarCodigo() {
    const codigoIngresado = document.getElementById('codigoAcceso').value;
    const errorMsg = document.getElementById('errorMsg');
    
    if (codigoIngresado === CODIGO_CORRECTO) {
        // ‚úÖ C√ìDIGO CORRECTO
        errorMsg.style.display = 'none';
        
        // Ocultar pantalla de login
        document.getElementById('loginOverlay').style.display = 'none';
        
        // Mostrar contenedor de la app
        document.getElementById('app-container').style.display = 'block';
        
        // Cargar la Power App
        cargarPowerApp();
    } else {
        // ‚ùå C√ìDIGO INCORRECTO
        errorMsg.style.display = 'block';
        document.getElementById('codigoAcceso').style.borderColor = '#dc3545';
    }
}

function cargarPowerApp() {
    // Verificar que el App ID no sea el de ejemplo
    if (APP_ID.includes("e6fea69f-80e5-4579-8f01-f087a031aee6") || APP_ID.length < 10) {
        alert("‚ùå Error: No has configurado el App ID. Reemplaza 'TU_APP_ID_AQU√ç_PEGALO' por tu App ID real.");
        return;
    }
    
    // Cargar la Power App embebida
    powerapps.embed({
        appId: APP_ID,
        height: "100%",
        width: "100%",
        hideNav: true,          // Oculta la barra de Power Apps
        target: "#app-container"
    });
}

// Permitir presionar ENTER para ingresar
document.getElementById('codigoAcceso').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        verificarCodigo();
    }
});

// Enfocar autom√°ticamente el campo de c√≥digo
document.getElementById('codigoAcceso').focus();
</script>

</body>
</html>
